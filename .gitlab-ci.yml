build-job:
  image: ghcr.io/tenstorrent/tt-zephyr-platforms/ci-image:v19.4.2
  script:
    - echo "Building Zephyr platforms..."
    # Replace the existing tt-zephyr-platforms with the current commit
    - rm -r /tt-zephyr/tt-zephyr-platforms
    - ln -s $CI_PROJECT_DIR /tt-zephyr/tt-zephyr-platforms
    - cd /tt-zephyr/tt-zephyr-platforms
    - west packages pip --install
    - west update
    - cd /tt-zephyr
    - ./tt-zephyr-platforms/scripts/ci/build-grendel.sh

  tags:
    - 8-core

pr-tests:
  needs: [build-job]
  script:
    - echo "CI Dry run (PR checks)"
  rules:
    - if: $CI_PIPELINE_SOURCE == "external_pull_request_event"
  tags:
    - 8-core

main-tests:
  needs: [build-job]
  script:
    - echo "CI Dry run"
  tags:
    - 8-core
